define([],function(){function e(e){require(["jquery","common/regexhelper/regexhelper","wsbcore/growl","libs/jquery/plugins/jquery.watermark/jquery.watermark"],function(r,i){function s(){u(!1);var t=a.css("background-color"),i=c(t),s=.2>i?"light":"dark";n.addClass("submitting-"+s);var o=r("#subscribe-email-field-"+e.elementId),l=o.val();o.on("focus",function(){n.removeClass("submit-success-dark submit-success-light")});var m={email:l},b=function(){n.removeClass("submitting-dark submitting-light"),n.addClass("submit-success-"+s),o.attr("placeholder",l),o.attr("value","")},f=function(t){u(!0),n.removeClass("submitting-dark submitting-light");var i=e.sendErrorMessage,s=e.errorTitle,a="error";429===t.status&&e.tooManyRequestsErrorMessage&&(i=e.tooManyRequestsErrorMessage,e.tooManyRequestsErrorTitle&&(s=e.tooManyRequestsErrorTitle),a="warning"),d()?alert(i):r("<div></div>").sfGrowl({title:s||"",content:i,icon:a,fadetime:3e3})},v=[e.submitUrl,e.orionId,e.domainName].join("/"),g={type:"POST",success:b,error:f,url:v,contentType:"application/json; charset=UTF-8",data:JSON.stringify(m),dataType:"json"};r.ajax(g),u(!1)}var a,n,o="form-button-disabled",l="form-value-invalid",u=(e.showMessage,function(e){e?(a.removeClass(o),a.removeAttr("disabled")):(a.addClass(o),a.attr("disabled","disabled"))}),d=function(){{var e="#mobile-site-view";t?t.find(e):r(e)}return r(e).length>0},c=function(e){e=e.toString();var t=e.replace(/[^\d,]/g,"").split(","),r=t[0],i=t[1],s=t[2];return t.length>3&&"0"===t[3]?0:1-(.299*r+.587*i+.114*s)/255},m=function(){var t=r("#subscribe-email-field-"+e.elementId),i=r(t).attr("placeholder");i&&r(t).watermark(i)},b=function(t){var s=!0,a=r(t),n=a.val();return i.validateEmailAddress(n)||(s=!1),a.prev().html(s?"":e.emailValidationMessage),s?(a.removeClass(l),u(!0)):(a.addClass(l),u(!1)),s},f=function(){r("#subscribe-email-field-"+e.elementId).on("input",function(e){("keyup"!==e.type||9!==e.which)&&b(this)})};r(document).ready(function(){var i="#subscribe-submit-"+e.elementId;n=t?t.find(i):r(i),a=n.find(".wsb-subscribe-submit"),a.click(s),m(),u(!1),f()})})}var t;return{initializeSubmitButton:e,setDom:function(e){t=e}}});
//# sourceMappingURL=subscribe.published.js.map